
# Filter / Interceptor / AOP

<br/>
 

>## 3. AOP
**스프링의 3대 기반 기술 중 하나**

<br/>

`AOP`는 *Aspect Oriented Programming*의 약자로 '**관점 지향 프로그래밍**' 이라고 불린다. '관점'이라는 용어는 개발자들에게는 '**관심사**(concern)'라는 말로 통용된다. '관심사'는 개발 시 필요한 고민이나 염두에 두어야 하는 일이라고 생각할 수 있다. 코드를 작성하며 염두에 두는 일들은 주로 다음과 같다.

- 파라미터가 올바르게 들어왔는지
- 이 작업을 하는 사용자가 적절한 권한을 가진 사용자인지
- 이 작업에서 발생할 수 있는 모든 예외는 어떻게 처리해야 하는지

<br/>

위와 같은 사항들은 '핵심 로직'은 아니지만 코드를 온전하게 위해서 필요한데, AOP가 추구하는 것은 '관심사의 분리'이다. AOP는 개발자가 염두에 두어야 하는 일들은 별도의 '관심사'로 분리하고, 핵심 비지니스 로직만을 작성할 것을 권장한다.   
실제 실행은 개발자가 작성한 코드와 분리된 관심사가 결합된 상태의 코드가 실행된다. -> 개발자는 핵심 비지니스 로직에만 근거해 코드를 작성하고, 나머지는 어떤 관심사들과 결합할 것인지를 설정하는 것 만으로 모든 개발을 마칠 수 있다.

<br/>

**AOP를 사용하는 이유**
- 모듈을 상속받아 공통 기능을 부여하기에는 한계가 있음. (JAVA는 클래스 다중 상속 불가능)
- 기능 구현부분에 핵심코드와 공통기능코드가 섞여있을 시 보기에 불편하고 효율성이 떨어짐.

<br/>

**<정리>**   

**AOP**는 기능을 핵심 기능(비지니스 로직)과 공통 기능(공통 모듈)로 구분한 뒤에, 공통 기능을 필요로 하는 핵심 기능들에서 사용하는 방식.


<br/>

>### AOP 주요 개념

<br/>

- **`Aspect`** : 공통 기능 (흩어진 관심사 모듈화한 것)
- **`Target`** : `Aspect`를 적용하는 곳 (클래스, 메서드 ..)
- **`Advice`** : 실질적으로 어떤 일을 해야할 지에 대한 것, 실직적인 부가기능을 담은 구현체
- **`JoinPoint`** : `Advice`가 적용될 위치, 끼어들 수 있는 지점. 메서드 진입 시점, 생성자 호출 시점, 필드에서 값을 꺼내올 때 등 다양한 시점에 적용 가능
- **`PointCut`** : `JoinPoint`의 부분으로 실제로 `Advice`가 적용된 부분. 'A란 메서드의 진입 시점에 호출할 것'과 같이 더욱 구체적으로 `Advice`가 실행될 지점을 정할 수 있음.

<br/>

>### 스프링 AOP 특징

<br/>

- **프록시 패턴** 기반의 AOP 구현체   
프록시 객체를 쓰는 이유는 접근 제어 및 부가 기능을 추가하기 위해서!   


    client(호출부) -> proxy -> Target(핵심기능)

    1. client가 프록시에 요청해서 공통 기능을 실행
    2. 프록시가 다시 Target으로 가서 핵심 기능 실행
    3. 다시 공통 기능을 실행하기 위해 프록시로 와서 공통 기능 실행   
    <span style="color:gray">(프록시가 중간에서 '대행' 역할을 한다)</span>

    <br/>

    ✏ 프록시란 ?

- 스프링 빈에만 AOP 적용 가능   
- 모든 AOP 기능을 제공하는 것이 아닌 스프링 IoC와 연동하여 애플리케이션에서 가장 흔한 문제(중복코드, 프록시 클래스 작성의 번거로움, 객체들 간 관계 복잡도 증가 ...)에 대한 해결책을 지원하는 목적

<br/>

>### 스프링 AOP 구현방식

<br/>

- 방법1. XML 스키마 기반의 AOP구현

- 방법2. @Aspect 어노테이션 기반의 AOP구현







<br/>
<br/>

내용 참조 : https://engkimbs.tistory.com/746, https://hongku.tistory.com/114
